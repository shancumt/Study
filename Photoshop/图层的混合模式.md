[toc]
### 混合模式的原理
基色(下方图层) + 混合色 = 结果色
### 图层的混合模式
#### 图层混合模式的分类
![图层的混合模式](https://github.com/shancumt/Study/blob/master/Photoshop/pictures/2019-12-26.png?raw=true)
混合模式可以分为四类：

1. 一般型 ：正常、溶解

2. 变暗型 ：变暗、正片叠底、颜色加深、线性加深、深色

3. 变暗型 ：变亮、滤色、颜色减淡、线性减淡、浅色

4. 对比型 ：叠加、柔光、强光、亮光、线性光、点光、实色混合

5. 色差型的混合模式：差值、排除、减去、划分

6. 调色型：色相、饱和度、颜色、明度


####  一般型混合模式
##### 1. 正常模式
设不透明度为n，计算公式为：$n*H + (1-n)*J$
##### 2. 溶解
对每个像素而言，其结果色是基色或者混合色的随机值，取决于**不透明度**，不透明度高时，更多像素取自当前层，低时，更多像素取自背景层。 不透明的部分变成像素点进行扩散，随着不透明度的减低，扩散的像素点就变少了。

溶解模式的图层向正常模式下的图层进行ctrl+E合并可以保留像素点扩散的形式。从而一些在溶解模式下无法显示的滤镜效果可以显示出来

#### 变暗和变亮型
##### 1. 变暗和变亮

* 变暗
计算公式：$min(H,J)$，逐通道进行运算

* 变亮
计算公式：$max(H,J)$，逐通道进行运算

##### 2. 正片叠底和滤色

* 正片叠底

计算公式：$H*J/255$ ：逐通道进行计算   
任何颜色和黑色的混合结果都是黑色，任何颜色和白色的混合结果都是原来的颜色。

常用的加深模式，用于产生**阴影、去除白色和其它浅色**。如同将所有的图层都叠在一起，上方一束光投下来射到屏幕上。经常用到的模式，多用于做投影，效果比较细腻，相当于一块玻璃罩在基色上  
正片叠底即所谓**减色或CMYK混合模式**，现实中相当于用染料、水彩笔绘画效果。

* 滤色

计算公式：$255-(255-H)*(255-J)/255$，逐通道进行计算  
基色或混合色为白色时，结果为白色；任何颜料与黑色混合，结果色仍为原来颜色。 

常用的减淡方法，产生**发光效果**，如同将所有图层分开摆放，各有一束光通过图层，汇聚到一块屏幕上。  
滤色即所谓的**加色模式**，现实中相当于发光体发光的叠加效果。

##### 3. 颜色加深和颜色减淡

* 颜色加深

计算公式：$(H+J-255)*255/H$，逐通道进行计算  
如果两个通道的发光强度之和低于255，此通道结果色直接归0  
如果两个通道有一个通道为0，那么此结果色直接归0  

得到的效果比正片叠底更深，中调更饱和，高光减弱。多用于两图融合，产生强烈的暗部颜色，产生**强烈的对比效果**。

* 颜色减淡

计算公式：$J+H*J/(255-H) = 255*J/(255-H)$，逐通道进行计算  
任何颜色与黑色(J = 0)混合，混合结果都是黑色。

得到的效果比滤色更亮，**色彩对比更加强烈**，中调更饱和，高光增强。

##### 4. 线性加深和线性减淡

* 线性加深

计算公式：$H+J-255$，逐通道进行计算  
如果两个通道的发光强度之和低于255，此通道结果色直接归0  
如果两个通道有一个通道为0，此结果色直接归0  

得到的结果比颜色加深更深，比颜色加深饱和度低

* 线性减淡

计算公式：$H + J$，逐通道进行计算  
如果$H+J > 255$，则仍为255

得到的结果比颜色减淡更亮，但对比稍弱

##### 5. 深色和浅色

* 深色

计算公式：$min(H,J)$，三通道整体进行计算，不会产生新的颜色

该模式不会产生新的颜色，注意与**变暗**的区别

* 浅色

计算公式：$max(H,J)$，三通道整体进行计算，不会产生新的颜色

该模式不会产生新的颜色，注意与**变亮**的区别

#### 对比型

该组的特点是让亮的更亮，暗的更暗，每一个对比型的混合模式都可以看作变暗型和变亮型的结合

##### 1. 叠加

逐通道进行计算，在基色上附着混合色的结果，根据**基色**的不同而不同

* 如果基色大于128→结果色采用滤色算法（半值）   
结果色 = $255-(255-H)*(255-J)/128$
* 如果基色小于128→结果色采用正片叠底算法（半值）  
结果色 = $H*J/128$
* 如果基色 = 128→结果色 = 混合色 
* 如果混合色 = 128→结果色 = 基色

注意：中性色的色值随不同模式的不同而不同

##### 2. 柔光

逐通道进行计算，根据**混合色**的不同而不同

* 如果混合色大于128  
结果色 = $J+(2*H-255)*(J-J*J/255)/255$
* 如果混合色小于128  
结果色 = $J+(2*H-255)*(sqrt(J/255)*255-J)/255$
* 如果混合色等于128→结果色=基色  

中性色图层：128（RGB） 或者   （推荐后面这种方法）图层，新建图层，柔光模式，勾选填充柔光中性色可以直接创建中性色图层   注意：不同的模式有不同的中性色

##### 3. 强光
可以理解为强化版的柔光，算法和叠加一样，但主导色为**混合色**
A层在上，对A叠加；B层在上，对B强光：两种情况得到的效果是一样的

* 如果混合色大于128→滤色（半值）  
结果色 = $255-(255-H)*(255-J)/128$
* 如果混合色小于128→正片叠底（半值）  
结果色 = $H*J/128$
* 如果混合色为白色→结果色=白色
* 如果混合色为黑色→结果色=黑色

##### 4. 亮光

以**混合色**作为主导,与柔光相似，但比柔光强烈
* 如果混合色大于128→类似颜色减淡  
结果色 = $J/(2*(255-H))*255$
* 如果混合色小于128→类似颜色加深  
结果色 = $255-(255-J)*(2*H)*255$

##### 5. 线性光

**明暗对比特别强**，亮的特变亮，暗的特别暗

此线性光公式：$2*H+J-255$
* H=128，结果为基色
* H大于128，变亮，超过255都视为255
* H小于128，变暗，出现负数都视为0

中性色图层的运用，制作光线

##### 6. 柔光、强光、亮光、线性光的比较

![比较](https://raw.githubusercontent.com/shancumt/Study/master/Photoshop/pictures/Screenshot_2019-12-07-18-40-22-016_tv.danmaku.bili.png)

##### 7. 点光

逐通道进行计算

![点光的混合模式](https://github.com/shancumt/Study/blob/master/Photoshop/pictures/Screenshot_2019-12-07-18-54-13-484_tv.danmaku.bili.png?raw=true)

* 高于128的混合色替换比他暗的基色
* 低于128的混合色替换比他亮的基色
* 等于128的混合色是中性色，无替换效果
* 白色或黑色（255/0）会替换所有的颜色

##### 8. 实色混合
逐通道进行运算，混合色的RGB值加到基色的RGB值  

![实色混合模式](https://raw.githubusercontent.com/shancumt/Study/master/Photoshop/pictures/Screenshot_2019-12-07-18-59-09-280_tv.danmaku.bili.png)

* 如果结果总和大于255，则值为255；
* 如果小于255，则为0

因此，此模式结果色只会有8种基本色，即RGBCMY与黑白。

增强画面对比（改变填充度。为什么不改变不透明度？不透明度针对的图层本身，填充度反映的是像素本身）

#### 色差型混合模式

##### 1. 差值

![差值原理图](../../../../%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90/%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0/pictures/Screenshot_2019-12-07-19-09-17-207_tv.danmaku.bili.png)

计算公式：$|H-J|$  
查看每个通道中的颜色信息  
并从基色中减去混合色或从混合色中减去基色，具体取决于哪一个颜色的亮度值更大  

如果混合色是一种比较固定的值，那么混合以后会出现一定的的反向效果

##### 2.排除

![排除](../../../../%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90/%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0/pictures/Screenshot_2019-12-07-19-12-01-801_tv.danmaku.bili.png)

减弱版的差值效果，创造一种与差值类似但对比度更低的效果

计算公式：$H+J-H*J/255$

##### 3. 减去

![减去](../../../../%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90/%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0/pictures/Screenshot_2019-12-07-19-15-41-728_tv.danmaku.bili.png)

计算公式：$J-H$  
查看每个通道中的颜色信息，并从基色中减去混合色，负值为零。
混合色越亮，结果色越暗；混合色越暗，结果色变暗程度越低  
中性色为黑色  
火焰变水墨

##### 4. 划分

![划分](../../../../%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90/%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0/pictures/Screenshot_2019-12-07-19-17-25-210_tv.danmaku.bili.png)

计算公式：$J/H*255$  
* 基色大于等于255，结果色为白  
* 基色小于混合色，结果色加深基色  
* 混合色为白色，结果色为基色  
* 混合色为黑色，结果色为白色  
中性色为白色

#### 调色型混合模式

##### 1. 色相模式

![色相模式](../../../../%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90/%E7%94%B5%E5%8A%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0/pictures/Screenshot_2019-12-07-19-26-59-942_tv.danmaku.bili.png)

用基色的明亮度和饱和度以及**混合色的色相**创建结果色
##### 2. 饱和度模式
用基色的明亮度和色相以及**混合色的饱和度**创建结果色
##### 3. 颜色模式
用基色的明亮度以及**混合色的色相和饱和度**创建结果色。黑白照片上色
##### 4. 明度模式
用基色的色相和饱和度以及**混合色的明亮度**创建结果色